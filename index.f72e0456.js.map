{"mappings":"oeACA,IAAAA,EAAAC,EAAA,S,iCAKA,MAMMC,EAAcC,SAASC,cAAc,wBAC3C,IAAIC,EAAS,GAgBNC,eAAeC,IAGpB,MAAO,CAAEC,aATXF,iBACE,MAAMG,KAAEA,SAAeT,EAAAU,QAAMC,IAC3B,0FAEF,OAAOF,C,CAGcG,GAAiBC,MAAK,EAACL,OAAEA,KAAaA,I,CAK7D,SAASM,EAAaC,GACpBR,IAAYM,MAAK,EAACL,OAAEA,MAClB,GAAIO,EAAS,CACXA,EAAQC,SAAQC,IACd,MAAMC,UAAEA,EAASC,aAAEA,GAAiBF,EACpCT,EAAOQ,SAAQ,EAACI,KAAEA,EAAIC,GAAEA,MAClBH,EAAUI,SAASD,KACjBH,EAAUK,OAAS,GACrBL,EAAUM,OAAO,EAAGN,EAAUK,OAAS,GAEzCL,EAAUM,OAAON,EAAUO,QAAQJ,GAAK,EAAGD,IAE7CH,EAAKS,YAAcR,EAAUS,KAAK,MAC9BV,EAAKE,eACPF,EAAKE,aAAeA,EAAaS,MAAM,EAAG,GAAE,GAE9C,IAEJ,MAAMC,EAOZ,SAAsBd,GACpB,OAAOA,EACJa,MAAM,EAAG,GACTE,KACC,EAACC,eACCA,EAAcZ,aACdA,EAAYD,UACZA,EAASc,YACTA,EAAWC,aACXA,EAAYZ,GACZA,MAEAhB,EAAS4B,EACT,IAAIC,EAAY,GAEdA,EADEF,EACU,kCAA6BA,IAE7B,mCAGd,IAAIG,EAAY,GAChB,IAAK,IAAIC,EAAI,EAAGA,GAAK,EAAGA,IAAK,CAC3B,IAAIC,EAAY,YACR,EAAJD,EAAQH,EACVI,EAAY,UACC,EAAJD,EAAQ,EAAIH,IACrBI,EAAY,kBAEdF,GAAa,wBAAwBE,a,CAMvC,MAAO,4EAA4EhB,0DACvCa,WAAmBH,yBAAsCV,2JAG1DU,4IAG5Bb,OAAeC,2WASME,oBAlBD,GAArBiB,KAAKC,MAAMlC,0qBA6BnB,IAGTsB,KAAK,G,CAvEea,CAAazB,GAC5Bb,IACFA,EAAYuC,UAAYZ,E,KApCvB7B,EAAAU,QAAMC,IAFX,6FAEoBE,MAAKJ,GAClBA,EAAKA,OA0G8BI,MAAK,EAACE,QAAEA,KAC7CD,EAAaC","sources":["src/js/weekly-trends.js"],"sourcesContent":["// weekly-trends\nimport axios from 'axios';\nimport Notiflix from 'notiflix';\nimport {addRating} from './rating'\nimport { add } from 'lodash';\n\nconst URL =\n  'https://api.themoviedb.org/3/trending/movie/week?api_key=ee5376443abaeb243d053aa1ffc4ea05';\nconst IMG_BASE_URL = `https://image.tmdb.org/t/p`;\nconst BASE_URL = 'https://api.themoviedb.org/3';\nconst IMG_W400 = `/w400`;\nconst API_KEY = 'ee5376443abaeb243d053aa1ffc4ea05';\nconst galleryList = document.querySelector('.gallery-weekly-list');\nlet rating = '';\n\nfunction getTrendData() {\n  const URL =\n    'https://api.themoviedb.org/3/trending/movie/week?api_key=ee5376443abaeb243d053aa1ffc4ea05';\n\n  return axios.get(URL).then(data => {\n    return data.data;\n  });\n}\nasync function getMovieGenres() {\n  const { data } = await axios.get(\n    `${BASE_URL}/genre/movie/list?api_key=${API_KEY}`\n  );\n  return data;\n}\nexport async function getGenres() {\n  const genres = await getMovieGenres().then(({ genres }) => genres);\n\n  return { genres };\n}\n\nfunction renderMarkup(results) {\n  getGenres().then(({ genres }) => {\n    if (results) {\n      results.forEach(film => {\n        const { genre_ids, release_date } = film;\n        genres.forEach(({ name, id }) => {\n          if (genre_ids.includes(id)) {\n            if (genre_ids.length > 2) {\n              genre_ids.splice(2, genre_ids.length - 1);\n            }\n            genre_ids.splice(genre_ids.indexOf(id), 1, name);\n          }\n          film.genre_names = genre_ids.join(', ');\n          if (film.release_date) {\n            film.release_date = release_date.slice(0, 4);\n          }\n        });\n      });\n      const markupList = createMarkup(results);\n      if (galleryList) {\n        galleryList.innerHTML = markupList;\n      }\n    }\n  });\n}\nfunction createMarkup(results) {\n  return results\n    .slice(0, 3)\n    .map(\n      ({\n        original_title,\n        release_date,\n        genre_ids,\n        poster_path,\n        vote_average,\n        id,\n      }) => {\n        rating = vote_average;\n        let posterIMG = ``;\n        if (poster_path) {\n          posterIMG = `${IMG_BASE_URL}${IMG_W400}${poster_path}`;\n        } else {\n          posterIMG = 'https://i.ibb.co/C0LFwTh/OIF.jpg';\n        }\n\n        let starIcons = '';\n        for (let i = 1; i <= 5; i++) {\n          let starClass = 'fa-star-o';\n          if (i * 2 < vote_average) {\n            starClass = 'fa-star';\n          } else if (i * 2 - 1 < vote_average) {\n            starClass = 'fa-star-half-o';\n          }\n          starIcons += `<span class=\"fa star ${starClass}\"> </span>`;\n        }\n\n        // Calculate the width based on the rating value\n        const width = Math.round(rating) * 10;\n\n        return `<li class='gallery-weekly__list-elem hover-cursor' data-catalog-item id='${id}'>\n          <img class='gallery-weekly__image' src=\"${posterIMG}\" alt=\"${original_title}\" loading=\"lazy\" id='${id}'>\n          <div class='gallery-weekly__all-info'>\n            <div class=\"gallery-weekly__info\">\n              <h3 class= 'gallery-weekly__title'>${original_title}</h3>\n              <div class='cards-list_second_line'>\n                <div class='cards-list__text color-h'>\n                  <p>${genre_ids} | ${release_date}</p>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"form_item form_item_weekly\">\n            <div class=\"form_lebel\"> </div>\n            <div data-ajax=\"true\" class=\"rating rating_weekly  rating_set rating-hero\">\n              <div class=\"rating_body\">\n                <div class=\"rating_active ${id}\" style=\"width: ${width}%;\"></div>\n                <div class=\"rating_items\">\n                  <input type=\"radio\" aria-label=\"1 stars\" class=\"rating_item\" value=\"1\" name=\"rating\">\n                  <input type=\"radio\" aria-label=\"2 stars\" class=\"rating_item\" value=\"2\" name=\"rating\">\n                  <input type=\"radio\" aria-label=\"3 stars\" class=\"rating_item\" value=\"3\" name=\"rating\">\n                  <input type=\"radio\" aria-label=\"4 stars\" class=\"rating_item\" value=\"4\" name=\"rating\">\n                  <input type=\"radio\" aria-label=\"5 stars\" class=\"rating_item\" value=\"5\" name=\"rating\">\n                </div>\n              </div>\n            </div>\n          </div>\n        </li>`;\n      }\n    )\n    .join('');\n}\nexport const getWeeklyTrends = getTrendData().then(({ results }) => {\n  return renderMarkup(results);\n});\n"],"names":["$2shzp","parcelRequire","$d395fb91404b7f70$var$galleryList","document","querySelector","$d395fb91404b7f70$var$rating","async","$d395fb91404b7f70$export$c5604fa8028da00","genres","data","default","get","$d395fb91404b7f70$var$getMovieGenres","then","$d395fb91404b7f70$var$renderMarkup","results","forEach","film","genre_ids","release_date","name","id","includes","length","splice","indexOf","genre_names","join","slice","markupList","map","original_title","poster_path","vote_average","posterIMG","starIcons","i","starClass","Math","round","$d395fb91404b7f70$var$createMarkup","innerHTML"],"version":3,"file":"index.f72e0456.js.map"}